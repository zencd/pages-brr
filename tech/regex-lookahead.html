<!DOCTYPE html>
<html xmlns:og="http://ogp.me/ns#">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Regex lookahead - Soviet Groove</title>
    <link rel="stylesheet" type="text/css" href="/tech/static/main2.css"/>
    <link rel="stylesheet" type="text/css" href="/tech/static/player-bar.css" />
    <link rel="shortcut icon" type="image/png" href="/tech/static/favicon.png"/>
    
    

    <link rel="canonical" href="https://brokenroll.com/tech/regex-lookahead.html" />
    <style id="pageSpecificStyle">


body {
background:
    linear-gradient(to bottom, rgb(0, 0, 0, 0.0) 0%, rgb(0, 0, 0, 0.0) 100%),
    url(/tech/static/psych.jpg) no-repeat center center fixed;
background-size: auto, cover;
}
.wrap1 {
background:
  linear-gradient(to bottom, rgb(34, 34, 34, 0) 0px, rgb(34, 34, 34, 0.8) 70px, rgb(34, 34, 34, 0.9) 80px, rgb(34, 34, 34, 1) 100px),
  url(/tech/static/scanlines.png),
  url(/tech/static/psych.jpg) no-repeat top center fixed;
background-size: 100%, auto, 650px auto;
padding-top: 100px;
}


    </style>
</head>
<body style="background-color: #222;" data-devel="false" data-site-code="itb">

<div class="mainMenu" style="position: fixed; top: 0; left: 0; height: 40px; line-height: 40px; z-index: 1000; width: 100%; text-align: center;">
    <a href="/tech/">TECH BLOG</a>
    <a href="/tech/tags/">TAGS</a>
    <a href="/tech/rss.xml">RSS</a>
</div>

<div class="wrap0">
    <div class="wrap1">
        <div class="wrap2">
            <div id="pageContent">
            <!-- pageContent begin -->
            



<h1 data-slug="regex-lookahead">Regex lookahead</h1>

<div class="textBlock tagList">
    <ul class="flatList">
    
    <li><a href="/tech/tags/regex.html">regex</a></li>
    
    </ul>
</div>


<div class="textBlock">В <a href="regex-escape.html">предыдущей заметке</a> задача ставилась так: удалить все символы перед определенным символом. Оригинальное решение работает ожидаемо только для части символов: для доллара уже не сработает, а для открывающих скобок вобще свалится с исключением:</div>

<pre class="textBlock">String baeldungIncorrect(String input, String find) {
  return find + input.replaceAll(".*" + find, "");
}
</pre>

<div class="textBlock">Это ошибка. Исправим:</div>

<pre class="textBlock">String baeldungFixed(String input, String find) {
  return find + input.replaceAll(".*" + Pattern.quote(find), "");
}
</pre>

<div class="textBlock">Сначала вырезать символ, а потом его же добавлять обратно - получается довольно глупо. Я бы сделал это через единственную операцию замены, используя regex lookahead:</div>

<pre class="textBlock">String lookahead(String input, String find) {
  return input.replaceAll(".*(?=" + Pattern.quote(find) + ")", "");
}
</pre>

<div class="textBlock">Верификация:</div>

<pre class="textBlock">@Test
public void test() {
  assertEquals("$", baeldungIncorrect("12$34$56", "$"));
  assertEquals("$56", baeldungFixed("12$34$56", "$"));
  assertEquals("$56", lookahead("12$34$56", "$"));
}
</pre>




<p class="textBlock articleDate">
2024.05.06
</p>


            <!-- pageContent end -->
            </div>
            <div class="footer">
                2009&mdash;2024
                
<!--
                
-->
                <br>
                <br>
                <br>
            </div>
        </div>
    </div>
</div>

<div id="video-player" style="display: none;"></div>
<div id="player-bar" class="player-bar" style="display: none;"
     data-button-play="/tech/static/images/play.svg"
     data-button-pause="/tech/static/images/pause.svg"
     data-button-loader="/tech/static/images/loader.svg"
>
  <div class="player-bar-seek">
    <div class="player-bar-progress">
    </div>
    <div class="player-bar-title" style=""></div>
  </div>
  <div class="player-bar-controls">
    <img src="" class="play-button"><img src="/tech/static/images/close.svg" class="close-button">
  </div>
</div>


<script async src="/tech/static/main.js"></script>
<script src="/tech/static/audio-player-core.js"></script>
<script src="/tech/static/audio-player-ui.js"></script>
<!--<script src="https://cdn.jsdelivr.net/npm/fuse.js@7.0.0"></script>-->

<script>
const books = [
  {
    title: "Old Man's War",
    author: {
      firstName: 'John',
      lastName: 'Scalzi'
    }
  },
  {
    title: 'The Lock Artist',
    author: {
      firstName: 'Steve',
      lastName: 'Hamilton'
    }
  }
]

// 2. Set up the Fuse instance
//const fuse = new Fuse(books, {keys: ['title', 'author.firstName']})
//console.log('fuse', fuse)
//var res = fuse.search('jon')
//console.log('res', res)
</script>

</body>
</html>